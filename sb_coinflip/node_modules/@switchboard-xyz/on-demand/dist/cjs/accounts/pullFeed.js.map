{"version":3,"file":"pullFeed.js","sourceRoot":"","sources":["../../../src/accounts/pullFeed.ts"],"names":[],"mappings":"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","sourcesContent":["import {\n  SOL_NATIVE_MINT,\n  SPL_ASSOCIATED_TOKEN_ACCOUNT_PROGRAM_ID,\n  SPL_SYSVAR_INSTRUCTIONS_ID,\n  SPL_SYSVAR_SLOT_HASHES_ID,\n  SPL_TOKEN_PROGRAM_ID,\n} from '../constants.js';\nimport { InstructionUtils } from '../instruction-utils/instruction-utils.js';\nimport {\n  Secp256k1InstructionUtils,\n  type Secp256k1Signature,\n} from '../instruction-utils/secp256k1-instruction-utils.js';\nimport type {\n  FeedEvalResponse,\n  FeedRequest,\n  FetchSignaturesConsensusResponse,\n} from '../oracle-interfaces/gateway.js';\nimport * as spl from '../utils/index.js';\nimport { isMainnetConnection } from '../utils/index.js';\nimport { loadLookupTables } from '../utils/index.js';\nimport { getLutKey, getLutSigner } from '../utils/lookupTable.js';\n\nimport { Oracle } from './oracle.js';\nimport { Queue } from './queue.js';\nimport { State } from './state.js';\n\nimport type { Program } from '@coral-xyz/anchor-31';\nimport { BN, web3 } from '@coral-xyz/anchor-31';\nimport type { IOracleJob } from '@switchboard-xyz/common';\nimport {\n  Big,\n  CrossbarClient,\n  CrossbarNetwork,\n  FeedHash,\n  NonEmptyArrayUtils,\n} from '@switchboard-xyz/common';\nimport { Buffer } from 'buffer';\n\nexport interface CurrentResult {\n  value: BN;\n  stdDev: BN;\n  mean: BN;\n  range: BN;\n  minValue: BN;\n  maxValue: BN;\n  slot: BN;\n  minSlot: BN;\n  maxSlot: BN;\n}\n\nexport interface CompactResult {\n  stdDev: number;\n  mean: number;\n  slot: BN;\n}\n\nexport interface OracleSubmission {\n  oracle: web3.PublicKey;\n  slot: BN;\n  value: BN;\n}\n\nexport interface PullFeedAccountData {\n  submissions: OracleSubmission[];\n  authority: web3.PublicKey;\n  queue: web3.PublicKey;\n  feedHash: Uint8Array;\n  initializedAt: BN;\n  permissions: BN;\n  maxVariance: BN;\n  minResponses: number;\n  name: Uint8Array;\n  sampleSize: number;\n  lastUpdateTimestamp: BN;\n  lutSlot: BN;\n  result: CurrentResult;\n  maxStaleness: number;\n  minSampleSize: number;\n  historicalResultIdx: number;\n  historicalResults: CompactResult[];\n}\n\nexport type MultiSubmission = {\n  values: BN[];\n  signature: Buffer; // TODO: Does this need to be made a Uint8Array too?\n  recoveryId: number;\n};\n\nexport class OracleResponse {\n  constructor(\n    readonly oracle: Oracle,\n    readonly value: Big | null,\n    readonly error: string\n  ) {}\n\n  shortError(): string | undefined {\n    if (this.error === '[]') {\n      return undefined;\n    }\n    const parts = this.error.split('\\n');\n    return parts[0];\n  }\n}\n\nfunction padStringWithNullBytes(\n  input: string,\n  desiredLength: number = 32\n): string {\n  const nullByte = '\\0';\n  while (input.length < desiredLength) {\n    input += nullByte;\n  }\n  return input;\n}\n\nexport type FeedSubmission = { value: Big; slot: BN; oracle: web3.PublicKey };\n\nexport function toFeedValue(\n  submissions: FeedSubmission[],\n  onlyAfter: BN\n): FeedSubmission | null {\n  let values = submissions.filter(x => x.slot.gt(onlyAfter));\n  if (values.length === 0) {\n    return null;\n  }\n  values = values.sort((x, y) => (x.value.lt(y.value) ? -1 : 1));\n  return values[Math.floor(values.length / 2)];\n}\n\nfunction getIsSolana(chain?: string) {\n  return chain === undefined || chain === 'solana';\n}\n\nfunction getIsMainnet(network?: string) {\n  return network === 'mainnet' || network === 'mainnet-beta';\n}\n\n/**\n *  Checks if the pull feed account needs to be initialized.\n *\n *  @param connection The connection to use.\n *  @param programId The program ID.\n *  @param pubkey The public key of the pull feed account.\n *  @returns A promise that resolves to a boolean indicating if the account needs to be initialized.\n */\nasync function checkNeedsInit(\n  connection: web3.Connection,\n  programId: web3.PublicKey,\n  pubkey: web3.PublicKey\n): Promise<boolean> {\n  const accountInfo = await connection.getAccountInfo(pubkey);\n  if (accountInfo === null) return true;\n\n  const owner = accountInfo.owner;\n  if (!owner.equals(programId)) return true;\n\n  return false;\n}\n\n/**\n * PullFeed account management for persistent price feeds\n *\n * The PullFeed class manages on-chain feed accounts that store price\n * history and configuration. While the quote approach is more efficient\n * for most use cases, feeds are useful when you need:\n *\n * - Persistent price history on-chain\n * - Standardized addresses for multiple consumers\n * - Price archives and analytics\n * - Compatibility with programs expecting traditional feeds\n *\n * ## Key Features\n *\n * - **Price History**: Stores historical price data on-chain\n * - **Job Management**: Configure data sources via IPFS-stored jobs\n * - **Update Control**: Fine-grained control over update parameters\n * - **LUT Integration**: Automatic lookup table management\n *\n * @example\n * ```typescript\n * // Create a new feed\n * const [pullFeed, feedKp] = PullFeed.generate(program);\n * await pullFeed.initIx({\n *   name: \"BTC/USD\",\n *   queue: queuePubkey,\n *   maxVariance: 1.0,\n *   minResponses: 3,\n *   feedHash: jobHash,\n * });\n *\n * // Update the feed\n * const [updateIx, responses] = await pullFeed.fetchUpdateIx();\n * ```\n *\n * @class PullFeed\n */\nexport class PullFeed {\n  gatewayUrl: string;\n  pubkey: web3.PublicKey;\n  configs: {\n    queue: web3.PublicKey;\n    maxVariance: number;\n    minResponses: number;\n    feedHash: Buffer;\n    minSampleSize: number;\n  } | null;\n  data: PullFeedAccountData | null;\n  jobs: IOracleJob[] | null;\n  lut: web3.AddressLookupTableAccount | null;\n  private network: CrossbarNetwork | null = null; // Cache network detection\n\n  /**\n   * Constructs a `PullFeed` instance.\n   *\n   * @param program - The Anchor program instance.\n   * @param pubkey - The public key of the pull feed account.\n   */\n  constructor(\n    readonly program: Program,\n    pubkey: web3.PublicKey | string\n  ) {\n    this.gatewayUrl = '';\n    this.pubkey = new web3.PublicKey(pubkey);\n    this.configs = null;\n    this.jobs = null;\n  }\n\n  /**\n   * Manually set the network for this feed\n   *\n   * This method allows you to explicitly set the network type, which\n   * will be used by methods that need network-specific configuration.\n   *\n   * @param {CrossbarNetwork} network - The network to use (SolanaMainnet or SolanaDevnet)\n   *\n   * @example\n   * ```typescript\n   * const feed = new PullFeed(program, feedPubkey);\n   * feed.setNetwork(CrossbarNetwork.SolanaDevnet);\n   * ```\n   */\n  setNetwork(network: CrossbarNetwork): void {\n    this.network = network;\n  }\n\n  /**\n   * Get the cached network type\n   *\n   * @returns {CrossbarNetwork | null} The network (SolanaMainnet, SolanaDevnet, or null if not yet determined)\n   */\n  getNetwork(): CrossbarNetwork | null {\n    return this.network;\n  }\n\n  static generate(program: Program): [PullFeed, web3.Keypair] {\n    const keypair = web3.Keypair.generate();\n    const feed = new PullFeed(program, keypair.publicKey);\n    return [feed, keypair];\n  }\n\n  async lookupTableKey(data?: PullFeedAccountData): Promise<web3.PublicKey> {\n    const lutSigner = getLutSigner(this.program.programId, this.pubkey);\n    const { lutSlot } = data ?? (await this.loadData());\n    return getLutKey(lutSigner, lutSlot);\n  }\n\n  /**\n   * Prefetch all lookup tables needed for the feed and queue.\n   * @returns A promise that resolves to an array of lookup tables.\n   * @throws if the lookup tables cannot be loaded.\n   */\n  async preHeatLuts(): Promise<web3.AddressLookupTableAccount[]> {\n    const data = await this.loadData();\n    const queue = new Queue(this.program, data.queue);\n    const oracleKeys = await queue.fetchOracleKeys();\n    const oracles = oracleKeys.map(k => new Oracle(this.program, k));\n    const lutOwners = [...oracles, queue, this];\n    const luts = await loadLookupTables(lutOwners);\n    return luts;\n  }\n\n  static async initTx(\n    program: Program,\n    params: {\n      name: string;\n      queue: web3.PublicKey;\n      maxVariance: number;\n      minResponses: number;\n      minSampleSize: number;\n      maxStaleness: number;\n      permitWriteByAuthority?: boolean;\n      payer?: web3.PublicKey;\n    } & ({ feedHash: Buffer } | { jobs: IOracleJob[] })\n  ): Promise<[PullFeed, web3.VersionedTransaction]> {\n    const [pullFeed, keypair] = PullFeed.generate(program);\n    const ix = await pullFeed.initIx(params);\n    const tx = await InstructionUtils.asV0TxWithComputeIxs({\n      connection: program.provider.connection,\n      ixs: [ix],\n    });\n    tx.sign([keypair]);\n    return [pullFeed, tx];\n  }\n\n  private static getPayer(\n    program: Program,\n    payer?: web3.PublicKey\n  ): web3.PublicKey {\n    return payer ?? program.provider.publicKey ?? web3.PublicKey.default;\n  }\n\n  private getPayer(payer?: web3.PublicKey): web3.PublicKey {\n    return PullFeed.getPayer(this.program, payer);\n  }\n\n  /**\n   *  Calls to initialize a pull feed account and to update the configuration account need to\n   *  compute the feed hash for the account (if one is not specified).\n   */\n  private static feedHashFromParams(params: {\n    queue: web3.PublicKey;\n    feedHash?: Buffer;\n    jobs?: IOracleJob[];\n  }): Buffer {\n    const hash = (() => {\n      if (params.feedHash) {\n        // If the feed hash is provided, use it.\n        return params.feedHash;\n      } else if (params.jobs?.length) {\n        // Else if jobs are provided, compute the feed hash from the queue and jobs.\n        return FeedHash.compute(params.queue.toBuffer(), params.jobs);\n      }\n      throw new Error('Either \"feedHash\" or \"jobs\" must be provided.');\n    })();\n    if (hash.byteLength === 32) return hash;\n    throw new Error('Feed hash must be 32 bytes');\n  }\n\n  async fetchQueue(): Promise<Queue> {\n    const data = await this.loadData();\n    return new Queue(this.program, data.queue);\n  }\n\n  async preHeatFeed(crossbarClient: CrossbarClient = CrossbarClient.default()) {\n    const loadConfigsPromise = this.loadConfigs();\n    const preHeatPromise = this.preHeatLuts();\n    const fetchQueuePromise = this.fetchQueue();\n\n    // Wait for all in parallel\n    await Promise.all([loadConfigsPromise, preHeatPromise, fetchQueuePromise]);\n\n    // Fetch gateway and load jobs in parallel\n    await this.loadJobs(crossbarClient);\n  }\n\n  async loadJobs(\n    crossbarClient: CrossbarClient = CrossbarClient.default()\n  ): Promise<IOracleJob[]> {\n    if (this.jobs) {\n      return this.jobs!;\n    }\n\n    // Detect and cache network if not already set\n    if (this.network === null) {\n      const isMainnet = await isMainnetConnection(\n        this.program.provider.connection\n      );\n      this.network = isMainnet\n        ? CrossbarNetwork.SolanaMainnet\n        : CrossbarNetwork.SolanaDevnet;\n    }\n\n    // Set the crossbar network based on detected/cached network\n    crossbarClient.setNetwork(this.network);\n\n    const configs = await this.loadConfigs();\n    const feedHash = Buffer.from(configs.feedHash);\n    this.jobs = await crossbarClient\n      .fetch(feedHash.toString('hex'))\n      .then(resp => resp.jobs);\n    return this.jobs!;\n  }\n\n  /**\n   * Initializes a pull feed account.\n   *\n   * @param {Program} program - The Anchor program instance.\n   * @param {PublicKey} queue - The queue account public key.\n   * @param {Array<IOracleJob>} jobs - The oracle jobs to execute.\n   * @param {number} maxVariance - The maximum variance allowed for the feed.\n   * @param {number} minResponses - The minimum number of job responses required.\n   * @param {number} minSampleSize - The minimum number of samples required for setting feed value.\n   * @param {number} maxStaleness - The maximum number of slots that can pass before a feed value is considered stale.\n   * @returns {Promise<web3.TransactionInstruction>} A promise that resolves to the transaction instruction.\n   */\n  async initIx(\n    params: {\n      name: string;\n      queue: web3.PublicKey;\n      maxVariance: number;\n      minResponses: number;\n      payer?: web3.PublicKey;\n      minSampleSize: number;\n      maxStaleness: number;\n      permitWriteByAuthority?: boolean;\n    } & ({ feedHash: Buffer } | { jobs: IOracleJob[] })\n  ): Promise<web3.TransactionInstruction> {\n    const program = this.program;\n    const feedHash = PullFeed.feedHashFromParams({\n      queue: params.queue,\n      feedHash: 'feedHash' in params ? params.feedHash : undefined,\n      jobs: 'jobs' in params ? params.jobs : undefined,\n    });\n    const payerPublicKey = this.getPayer(params.payer);\n    const maxVariance = Math.floor(params.maxVariance * 1e9);\n    const lutSigner = getLutSigner(program.programId, this.pubkey);\n    const recentSlot = await program.provider.connection.getSlot('finalized');\n    const lutKey = getLutKey(lutSigner, recentSlot);\n    const ix = program.instruction.pullFeedInit(\n      {\n        feedHash: feedHash,\n        maxVariance: new BN(maxVariance),\n        minResponses: params.minResponses,\n        name: Buffer.from(padStringWithNullBytes(params.name)),\n        recentSlot: new BN(recentSlot),\n        ipfsHash: new Uint8Array(32), // Deprecated.\n        minSampleSize: params.minSampleSize,\n        maxStaleness: params.maxStaleness,\n        permitWriteByAuthority: params.permitWriteByAuthority ?? null,\n      },\n      {\n        accounts: {\n          pullFeed: this.pubkey,\n          queue: params.queue,\n          authority: payerPublicKey,\n          payer: payerPublicKey,\n          systemProgram: web3.SystemProgram.programId,\n          programState: State.keyFromSeed(program),\n          rewardEscrow: spl.getAssociatedTokenAddressSync(\n            SOL_NATIVE_MINT,\n            this.pubkey\n          ),\n          tokenProgram: SPL_TOKEN_PROGRAM_ID,\n          associatedTokenProgram: SPL_ASSOCIATED_TOKEN_ACCOUNT_PROGRAM_ID,\n          wrappedSolMint: SOL_NATIVE_MINT,\n          lutSigner: lutSigner,\n          lut: lutKey,\n          addressLookupTableProgram: web3.AddressLookupTableProgram.programId,\n        },\n      }\n    );\n    return ix;\n  }\n\n  async closeIx(params: {\n    payer?: web3.PublicKey;\n  }): Promise<web3.TransactionInstruction> {\n    const payerPublicKey = this.getPayer(params.payer);\n    const lutSigner = getLutSigner(this.program.programId, this.pubkey);\n    const data = await this.loadData();\n    const lutKey = getLutKey(lutSigner, data.lutSlot);\n    const ix = this.program.instruction.pullFeedClose(\n      {},\n      {\n        accounts: {\n          pullFeed: this.pubkey,\n          authority: data.authority,\n          payer: payerPublicKey,\n          rewardEscrow: spl.getAssociatedTokenAddressSync(\n            SOL_NATIVE_MINT,\n            this.pubkey\n          ),\n          lutSigner: lutSigner,\n          lut: lutKey,\n          state: State.keyFromSeed(this.program),\n          tokenProgram: SPL_TOKEN_PROGRAM_ID,\n          associatedTokenProgram: SPL_ASSOCIATED_TOKEN_ACCOUNT_PROGRAM_ID,\n          systemProgram: web3.SystemProgram.programId,\n          addressLookupTableProgram: web3.AddressLookupTableProgram.programId,\n        },\n      }\n    );\n    return ix;\n  }\n\n  /**\n   * Set configurations for the feed.\n   *\n   * @param params\n   * @param params.feedHash - The hash of the feed as a `Uint8Array` or hexadecimal `string`. Only results signed with this hash will be accepted.\n   * @param params.authority - The authority of the feed.\n   * @param params.maxVariance - The maximum variance allowed for the feed.\n   * @param params.minResponses - The minimum number of responses required.\n   * @param params.minSampleSize - The minimum number of samples required for setting feed value.\n   * @param params.maxStaleness - The maximum number of slots that can pass before a feed value is considered stale.\n   * @returns A promise that resolves to the transaction instruction to set feed configs.\n   */\n  async setConfigsIx(params: {\n    name?: string;\n    authority?: web3.PublicKey;\n    maxVariance?: number;\n    minResponses?: number;\n    feedHash?: Buffer;\n    jobs?: IOracleJob[];\n    minSampleSize?: number;\n    maxStaleness?: number;\n    permitWriteByAuthority?: boolean;\n  }): Promise<web3.TransactionInstruction> {\n    const data = await this.loadData();\n    const name =\n      params.name !== undefined\n        ? Buffer.from(padStringWithNullBytes(params.name))\n        : null;\n    const feedHash =\n      params.feedHash || params.jobs\n        ? PullFeed.feedHashFromParams({\n            queue: data.queue,\n            feedHash: params.feedHash,\n            jobs: params.jobs,\n          })\n        : null;\n\n    const ix = this.program.instruction.pullFeedSetConfigs(\n      {\n        name: name,\n        feedHash: feedHash,\n        authority: params.authority ?? null,\n        maxVariance:\n          params.maxVariance !== undefined\n            ? new BN(Math.floor(params.maxVariance * 1e9))\n            : null,\n        minResponses: params.minResponses ?? null,\n        minSampleSize: params.minSampleSize ?? null,\n        maxStaleness: params.maxStaleness ?? null,\n        permitWriteByAuthority: params.permitWriteByAuthority ?? null,\n        ipfsHash: null, // Deprecated.\n      },\n      {\n        accounts: {\n          pullFeed: this.pubkey,\n          authority: data.authority,\n        },\n      }\n    );\n    return ix;\n  }\n\n  /**\n   * Fetch updates for the feed.\n   *\n   * @param {object} params_ - The parameters object.\n   * @param {string} [params_.gateway] - Optionally specify the gateway to use. If not specified, the gateway is automatically fetched.\n   * @param {number} [params_.numSignatures] - Number of signatures to fetch.\n   * @param {FeedRequest} [params_.feedConfigs] - Optionally specify the feed configs. If not specified, the feed configs are automatically fetched.\n   * @param {IOracleJob[]} [params_.jobs] - An array of `IOracleJob` representing the jobs to be executed.\n   * @param {CrossbarClient} [params_.crossbarClient] - Optionally specify the CrossbarClient to use.\n   * @param {Array<[BN, string]>} [recentSlothashes] - An optional array of recent slothashes as `[BN, string]` tuples.\n   * @param {FeedEvalResponse[]} [priceSignatures] - An optional array of `FeedEvalResponse` representing the price signatures.\n   * @param {boolean} [debug=false] - A boolean flag to enable or disable debug mode. Defaults to `false`.\n   * @returns {Promise<[TransactionInstruction | undefined, OracleResponse[], number, any[]]>} A promise that resolves to a tuple containing:\n   * - The transaction instruction to fetch updates, or `undefined` if not applicable.\n   * - An array of `OracleResponse` objects.\n   * - A number representing the successful responses.\n   * - An array containing usable lookup tables.\n   */\n  /**\n   * Fetches update instructions for this feed\n   *\n   * Retrieves fresh oracle data and creates the instructions to update\n   * the on-chain feed account. This method handles all the complexity\n   * of oracle communication and signature verification.\n   *\n   * @param {Object} params - Update parameters\n   * @param {number} params.numSignatures - Number of oracle signatures (defaults to minSampleSize + 33%)\n   * @param {IOracleJob[]} params.jobs - Optional job overrides\n   * @param {CrossbarClient} params.crossbarClient - Optional Crossbar client\n   * @param {number} params.retries - Number of retry attempts\n   * @param {string} params.chain - Chain identifier\n   * @param {string} params.network - Network (mainnet/devnet)\n   * @param {string} params.solanaRpcUrl - Optional RPC URL override\n   * @param {Record<string, string>} params.variableOverrides - Optional variable overrides for task execution\n   * @param {boolean} debug - Enable debug logging\n   * @param {web3.PublicKey} payer - Optional payer override\n   * @returns {Promise<[instructions, responses, success, luts, logs]>} Update transaction components\n   *\n   * @example\n   * ```typescript\n   * const [pullIx, responses, success, luts] = await pullFeed.fetchUpdateIx({\n   *   gateway: 'https://gateway.switchboard.xyz',\n   *   numSignatures: 3,\n   * });\n   *\n   * if (pullIx) {\n   *   const tx = await asV0Tx({\n   *     connection,\n   *     ixs: pullIx,\n   *     signers: [payer],\n   *     lookupTables: luts,\n   *   });\n   * }\n   * ```\n   */\n  async fetchUpdateIx(params: {\n    // Number of signatures to fetch.\n    numSignatures?: number;\n    jobs?: IOracleJob[];\n    crossbarClient?: CrossbarClient;\n    retries?: number;\n    variableOverrides?: Record<string, string>;\n  }): Promise<\n    [\n      web3.TransactionInstruction[] | undefined,\n      OracleResponse[],\n      number,\n      web3.AddressLookupTableAccount[],\n      string[],\n    ]\n  > {\n    const feedConfigs = await this.loadConfigs();\n    const numSignatures =\n      params.numSignatures ??\n      feedConfigs.minSampleSize + Math.ceil(feedConfigs.minSampleSize / 3);\n\n    return await PullFeed.fetchUpdateIx({\n      pullFeed: this,\n      numSignatures: numSignatures,\n      crossbarClient: params.crossbarClient,\n      variableOverrides: params.variableOverrides,\n    });\n  }\n  /**\n   * Loads the feed configurations (if not already cached) for this {@linkcode PullFeed} account from on chain.\n   * @returns A promise that resolves to the feed configurations.\n   * @throws if the feed account does not exist.\n   */\n  async loadConfigs(force?: boolean): Promise<{\n    queue: web3.PublicKey;\n    maxVariance: number;\n    minResponses: number;\n    feedHash: Buffer;\n    minSampleSize: number;\n  }> {\n    // If forcing a reload or configs are not already cached, load the configs.\n    if (force || !this.configs) {\n      this.configs = await (async () => {\n        const data = await this.loadData();\n        const maxVariance = data.maxVariance.toNumber() / 1e9;\n        return {\n          queue: data.queue,\n          maxVariance: maxVariance,\n          minResponses: data.minResponses,\n          feedHash: Buffer.from(data.feedHash),\n          minSampleSize: data.minSampleSize,\n        };\n      })();\n    }\n    return this.configs;\n  }\n\n  /**\n   * Fetches updates for a feed, returning instructions that must be executed in order at the front\n   * of the transaction.\n   *\n   * @param program - The Anchor program instance\n   * @param params - The parameters object\n   * @param params.feed - PullFeed address to fetch updates for\n   * @param params.chain - Optional chain identifier (defaults to \"solana\")\n   * @param params.network - Optional network identifier (\"mainnet\", \"mainnet-beta\", \"testnet\", \"devnet\")\n   * @param params.numSignatures - Number of signatures to fetch\n   * @param params.crossbarClient - Optional CrossbarClient instance to use\n   * @param recentSlothashes - Optional array of recent slothashes as [BN, string] tuples\n   * @param debug - Enable debug logging (default: false)\n   * @param payer - Optional transaction payer public key\n   * @returns Promise resolving to:\n   * - instructions: Array of instructions that must be executed in order:\n   *   [0] = Ed25519 program verification instruction\n   *   [1] = feed update instruction\n   * - oracleResponses: Array of responses from oracles\n   * - numSuccesses: Number of successful responses\n   * - luts: Array of AddressLookupTableAccount to include\n   * - failures: Array of errors that occurred during the fetch\n   */\n  static async fetchUpdateIx(params: {\n    pullFeed: PullFeed;\n    numSignatures: number;\n    crossbarClient?: CrossbarClient;\n    variableOverrides?: Record<string, string>;\n  }): Promise<\n    [\n      web3.TransactionInstruction[] | undefined,\n      OracleResponse[],\n      number,\n      web3.AddressLookupTableAccount[],\n      string[],\n    ]\n  > {\n    // Fetch the update using the `fetchUpdateManyIx` function\n    const [ixns, luts, report] = await PullFeed.fetchUpdateManyIx(\n      params.pullFeed.program,\n      {\n        feeds: [params.pullFeed],\n        numSignatures: params.numSignatures,\n        crossbarClient: params.crossbarClient,\n        variableOverrides: params.variableOverrides,\n      }\n    );\n\n    // Generate an OracleResponse for each oracle response in the returned report.\n    const oracleResponses = report.oracle_responses.map(x => {\n      // Because we only requested a single feed response, we can use the first one.\n      const feedResponse = x.feed_responses[0];\n\n      // The returned oracle_pubkey is a hex string, so we need to convert it to a PublicKey.\n      const oraclePubkeyBytes = Buffer.from(x.oracle_pubkey, 'hex');\n      const oraclePubkey = new web3.PublicKey(oraclePubkeyBytes);\n\n      const oracle = new Oracle(params.pullFeed.program, oraclePubkey);\n      const error = feedResponse.failure_error;\n\n      const oldDP = Big.DP;\n      Big.DP = 40;\n      const value = feedResponse.success_value\n        ? new Big(feedResponse.success_value).div(1e18)\n        : null;\n      Big.DP = oldDP;\n\n      return new OracleResponse(oracle, value, error);\n    });\n\n    // Find the number of successful responses.\n    const numSuccesses = oracleResponses.filter(({ value }) => value).length;\n\n    return [\n      /* instructions= */ numSuccesses ? ixns : undefined,\n      /* oracleResponses= */ oracleResponses,\n      /* numSuccesses= */ numSuccesses,\n      /* luts= */ luts,\n      /* failures= */ oracleResponses.map(x => x.error),\n    ];\n  }\n\n  /**\n   * Fetches updates for multiple feeds at once into a SINGLE tightly packed instruction.\n   * Returns instructions that must be executed in order, with the Ed25519 verification\n   * instruction placed at the front of the transaction.\n   *\n   * @param program - The Anchor program instance.\n   * @param params_ - The parameters object.\n   * @param params_.feeds - An array of PullFeed account public keys.\n   * @param params_.gateway - The gateway URL to use\n   * @param params_.recentSlothashes - The recent slothashes to use. If not provided, the latest 30 slothashes are fetched.\n   * @param params_.numSignatures - The number of signatures to fetch.\n   * @param params_.crossbarClient - Optionally specify the CrossbarClient to use.\n   * @param params_.payer - The payer of the transaction. If not provided, the payer is automatically fetched.\n   * @param debug - A boolean flag to enable or disable debug mode. Defaults to `false`.\n   * @returns A promise that resolves to a tuple containing:\n   * - An array of transaction instructions that must be executed in order:\n   *   [0] = Ed25519 program verification instruction\n   *   [1] = feed update instruction\n   * - An array of `AddressLookupTableAccount` to use.\n   * - The raw response data.\n   */\n  static async fetchUpdateManyIx(\n    program: Program,\n    params: {\n      feeds: PullFeed[];\n      numSignatures: number;\n      crossbarClient?: CrossbarClient;\n      variableOverrides?: Record<string, string>;\n      signatureInstructionIdx?: number; // position of the secp256k1 instruction in the transaction\n    }\n  ): Promise<\n    [\n      web3.TransactionInstruction[],\n      web3.AddressLookupTableAccount[],\n      FetchSignaturesConsensusResponse,\n    ]\n  > {\n    const feeds = (() => {\n      if (NonEmptyArrayUtils.safeValidate(params.feeds)) return params.feeds;\n      throw new Error('Invalid `feeds` array: cannot be empty');\n    })();\n    const crossbarClient = params.crossbarClient ?? CrossbarClient.default();\n\n    // Validate that (1) all of the feeds specified exist and (2) all of the feeds are on the same\n    // queue. Assuming that these conditions are met, we can map the feeds' data to their configs to\n    // request signatures from a gateway.\n    const needFetch = feeds.some(feed => !feed.data);\n    const feedDatas: (PullFeedAccountData | null)[] = needFetch\n      ? await PullFeed.loadMany(program, feeds)\n      : feeds.map(feed => feed.data);\n\n    const queue: web3.PublicKey = feedDatas[0]?.queue ?? web3.PublicKey.default;\n    const feedConfigs: FeedRequest[] = [];\n    for (let idx = 0; idx < feedDatas.length; idx++) {\n      const data = feedDatas[idx];\n      if (!data) {\n        const feed = feeds[idx];\n        throw new Error(`No feed found at ${feed.pubkey.toBase58()}}`);\n      } else if (!queue.equals(data.queue)) {\n        throw new Error('All feeds must be on the same queue');\n      }\n      feedConfigs.push({\n        maxVariance: data.maxVariance.toNumber() / 1e9,\n        minResponses: data.minResponses,\n        jobs: await crossbarClient\n          .fetch(Buffer.from(data.feedHash).toString('hex'))\n          .then(resp => resp.jobs),\n      });\n    }\n\n    const response = await Queue.fetchSignaturesConsensus(\n      /* program= */ program,\n      /* params= */ {\n        queue: queue,\n        crossbarClient,\n        feedConfigs,\n        numSignatures: params.numSignatures,\n        // useEd25519 will default to false (secp256k1) for backward compatibility\n      }\n    );\n\n    // Check if we have any valid oracle responses\n    if (!response.oracle_responses || response.oracle_responses.length === 0) {\n      throw new Error('No oracle responses received from gateway');\n    }\n\n    // Collect error messages from any oracles that failed\n    const oracleErrors: string[] = [];\n    response.oracle_responses.forEach((oracleResponse, idx) => {\n      if (oracleResponse.errors && oracleResponse.errors.length > 0) {\n        oracleErrors.push(\n          `Oracle ${idx} (${oracleResponse.oracle_pubkey}): ${oracleResponse.errors.join('; ')}`\n        );\n      }\n    });\n\n    const secpSignatures: Secp256k1Signature[] =\n      response.oracle_responses.map<Secp256k1Signature>(\n        (oracleResponse, responseIdx) => {\n          return {\n            ethAddress: Buffer.from(oracleResponse.eth_address, 'hex'),\n            signature: Buffer.from(oracleResponse.signature, 'base64'),\n            message: Buffer.from(oracleResponse.checksum, 'base64'),\n            recoveryId: oracleResponse.recovery_id,\n            oracleIdx: responseIdx,\n          };\n        }\n      );\n\n    // Check if we have any valid signatures before calling buildSecp256k1Instruction\n    if (secpSignatures.length === 0) {\n      const errorMessage =\n        oracleErrors.length > 0\n          ? `No valid oracle signatures received. Oracle errors:\\n${oracleErrors.join('\\n')}`\n          : 'No valid oracle signatures received. All oracles failed to provide signatures.';\n      throw new Error(errorMessage);\n    }\n\n    const secpInstruction = Secp256k1InstructionUtils.buildSecp256k1Instruction(\n      secpSignatures,\n      params.signatureInstructionIdx ?? 0\n    );\n\n    // Prepare the instruction data for the `pullFeedSubmitResponseManySecp` instruction.\n    const instructionData = {\n      slot: new BN(response.slot),\n      values: response.median_responses.map(({ value }) => new BN(value)),\n    };\n\n    // Prepare the accounts for the `pullFeedSubmitResponseManySecp` instruction.\n    const accounts = {\n      queue: queue!,\n      programState: State.keyFromSeed(program),\n      recentSlothashes: SPL_SYSVAR_SLOT_HASHES_ID,\n      payer: PullFeed.getPayer(program),\n      systemProgram: web3.SystemProgram.programId,\n      rewardVault: spl.getAssociatedTokenAddressSync(\n        SOL_NATIVE_MINT,\n        queue,\n        false\n      ),\n      tokenProgram: SPL_TOKEN_PROGRAM_ID,\n      tokenMint: SOL_NATIVE_MINT,\n      ixSysvar: SPL_SYSVAR_INSTRUCTIONS_ID,\n    };\n\n    //\n    // Prepare the remaining accounts for the `pullFeedSubmitResponseManySecp` instruction.\n    //\n\n    // We only want to include feeds that have succcessful responses returned.\n    const feedPubkeys = response.median_responses.map(median_response => {\n      // For each successful 'median' response, locate a feed that has the same corresponding feed hash.\n      const feedIndex = feedDatas.findIndex(data => {\n        const feedHashHex = Buffer.from(data!.feedHash).toString('hex');\n        return feedHashHex === median_response.feed_hash;\n      });\n      if (feedIndex >= 0) return feeds[feedIndex].pubkey;\n      return web3.PublicKey.default;\n    });\n    // For each oracle response, create the oracle and oracle stats accounts.\n    const oraclePubkeys = response.oracle_responses.map(response => {\n      return new web3.PublicKey(Buffer.from(response.oracle_pubkey, 'hex'));\n    });\n    const oracleFeedStatsPubkeys = oraclePubkeys.map(\n      oracle =>\n        web3.PublicKey.findProgramAddressSync(\n          [Buffer.from('OracleStats'), oracle.toBuffer()],\n          program.programId\n        )[0]\n    );\n    const remainingAccounts: web3.AccountMeta[] = [\n      ...feedPubkeys.map(feedPubkey => ({\n        pubkey: feedPubkey,\n        isSigner: false,\n        isWritable: true,\n      })),\n      ...oraclePubkeys.map(oraclePubkey => ({\n        pubkey: oraclePubkey,\n        isSigner: false,\n        isWritable: false,\n      })),\n      ...oracleFeedStatsPubkeys.map(oracleFeedStatsPubkey => ({\n        pubkey: oracleFeedStatsPubkey,\n        isSigner: false,\n        isWritable: true,\n      })),\n    ];\n\n    const submitResponseIx =\n      program.instruction.pullFeedSubmitResponseConsensus(instructionData, {\n        accounts,\n        remainingAccounts,\n      });\n\n    // Load the lookup tables for the feeds and oracles.\n    const loadLookupTables = spl.createLoadLookupTables();\n    const luts = await loadLookupTables([\n      // ...feedPubkeys.map(pubkey => new PullFeed(program, pubkey)),\n      // ...oraclePubkeys.map(pubkey => new Oracle(program, pubkey)),\n    ]);\n\n    return [[secpInstruction, submitResponseIx], luts, response];\n  }\n\n  static async fetchUpdateManyLightIx(\n    program: Program,\n    params: {\n      feeds: PullFeed[];\n      chain?: string;\n      network?: 'mainnet' | 'mainnet-beta' | 'testnet' | 'devnet';\n      recentSlothashes?: Array<[BN, string]>;\n      numSignatures: number;\n      crossbarClient?: CrossbarClient;\n      payer?: web3.PublicKey;\n      variableOverrides?: Record<string, string>;\n    },\n    debug: boolean = false\n  ): Promise<\n    [\n      web3.TransactionInstruction[],\n      web3.AddressLookupTableAccount[],\n      FetchSignaturesConsensusResponse,\n    ]\n  > {\n    const isSolana = getIsSolana(params.chain);\n    const isMainnet = getIsMainnet(params.network);\n\n    const crossbarClient = params.crossbarClient ?? CrossbarClient.default();\n\n    const feeds = (() => {\n      if (NonEmptyArrayUtils.safeValidate(params.feeds)) return params.feeds;\n      throw new Error('Invalid `feeds` array: cannot be empty');\n    })();\n\n    // Validate that (1) all of the feeds specified exist and (2) all of the feeds are on the same\n    // queue. Assuming that these conditions are met, we can map the feeds' data to their configs to\n    // request signatures from a gateway.\n    const feedDatas = await PullFeed.loadMany(program, params.feeds);\n    const queue: web3.PublicKey = feedDatas[0]?.queue ?? web3.PublicKey.default;\n    const feedConfigs: FeedRequest[] = [];\n    for (let idx = 0; idx < feedDatas.length; idx++) {\n      const data = feedDatas[idx];\n      if (!data) {\n        const feed = feeds[idx];\n        throw new Error(`No feed found at ${feed.pubkey.toBase58()}}`);\n      } else if (!queue.equals(data.queue)) {\n        throw new Error('All feeds must be on the same queue');\n      }\n      feedConfigs.push({\n        maxVariance: data.maxVariance.toNumber() / 1e9,\n        minResponses: data.minResponses,\n        jobs: await params.feeds[idx].loadJobs(crossbarClient),\n      });\n    }\n\n    // If we are using Solana, we can use the queue that the feeds are on. Otherwise, we need to\n    // load the default queue for the specified network.\n    const solanaQueue = isSolana\n      ? queue\n      : spl.getDefaultQueueAddress(isMainnet);\n    if (debug) console.log(`Using queue ${solanaQueue.toBase58()}`);\n\n    const response = await Queue.fetchSignaturesConsensus(\n      /* program= */ program,\n      /* params= */ {\n        queue: solanaQueue,\n        crossbarClient,\n        feedConfigs,\n        numSignatures: params.numSignatures,\n        variableOverrides: params.variableOverrides,\n        // useEd25519 will default to false (secp256k1) for backward compatibility\n      }\n    );\n\n    // Check if we have any valid oracle responses\n    if (!response.oracle_responses || response.oracle_responses.length === 0) {\n      throw new Error('No oracle responses received from gateway');\n    }\n\n    // Collect error messages from any oracles that failed\n    const oracleErrors: string[] = [];\n    response.oracle_responses.forEach((oracleResponse, idx) => {\n      if (oracleResponse.errors && oracleResponse.errors.length > 0) {\n        oracleErrors.push(\n          `Oracle ${idx} (${oracleResponse.oracle_pubkey}): ${oracleResponse.errors.join('; ')}`\n        );\n      }\n    });\n\n    const secpSignatures: Secp256k1Signature[] =\n      response.oracle_responses.map<Secp256k1Signature>(\n        (oracleResponse, responseIdx) => {\n          return {\n            ethAddress: Buffer.from(oracleResponse.eth_address, 'hex'),\n            signature: Buffer.from(oracleResponse.signature, 'base64'),\n            message: Buffer.from(oracleResponse.checksum, 'base64'),\n            recoveryId: oracleResponse.recovery_id,\n            oracleIdx: responseIdx,\n          };\n        }\n      );\n\n    // Check if we have any valid signatures before calling buildSecp256k1Instruction\n    if (secpSignatures.length === 0) {\n      const errorMessage =\n        oracleErrors.length > 0\n          ? `No valid oracle signatures received. Oracle errors:\\n${oracleErrors.join('\\n')}`\n          : 'No valid oracle signatures received. All oracles failed to provide signatures.';\n      throw new Error(errorMessage);\n    }\n\n    const secpInstruction = Secp256k1InstructionUtils.buildSecp256k1Instruction(\n      secpSignatures,\n      0\n    );\n\n    // Prepare the instruction data for the `pullFeedSubmitResponseManySecp` instruction.\n    const instructionData = {\n      slot: new BN(response.slot),\n      values: response.median_responses.map(({ value }) => new BN(value)),\n    };\n\n    // Prepare the accounts for the `pullFeedSubmitResponseManySecp` instruction.\n    const accounts = {\n      queue: queue!,\n      programState: State.keyFromSeed(program),\n      recentSlothashes: SPL_SYSVAR_SLOT_HASHES_ID,\n      payer: PullFeed.getPayer(program, params.payer),\n      systemProgram: web3.SystemProgram.programId,\n      rewardVault: spl.getAssociatedTokenAddressSync(\n        SOL_NATIVE_MINT,\n        queue,\n        !isSolana // TODO: Review this.\n      ),\n      tokenProgram: SPL_TOKEN_PROGRAM_ID,\n      tokenMint: SOL_NATIVE_MINT,\n      ixSysvar: SPL_SYSVAR_INSTRUCTIONS_ID,\n    };\n\n    //\n    // Prepare the remaining accounts for the `pullFeedSubmitResponseManySecp` instruction.\n    //\n\n    // We only want to include feeds that have succcessful responses returned.\n    const feedPubkeys: web3.PublicKey[] = response.median_responses.map(\n      median_response => {\n        // For each successful 'median' response, locate a feed that has the same corresponding feed hash.\n        const feedIndex = feedDatas.findIndex(data => {\n          const feedHashHex = Buffer.from(data!.feedHash).toString('hex');\n          return feedHashHex === median_response.feed_hash;\n        });\n        if (feedIndex >= 0) return params.feeds[feedIndex].pubkey;\n        if (debug) {\n          console.warn(`Feed not found for hash: ${median_response.feed_hash}`);\n        }\n        return web3.PublicKey.default;\n      }\n    );\n    // For each oracle response, create the oracle and oracle stats accounts.\n    const oraclePubkeys = response.oracle_responses.map(response => {\n      return new web3.PublicKey(Buffer.from(response.oracle_pubkey, 'hex'));\n    });\n    const remainingAccounts: web3.AccountMeta[] = [\n      ...feedPubkeys.map(feedPubkey => ({\n        pubkey: feedPubkey,\n        isSigner: false,\n        isWritable: true,\n      })),\n      ...oraclePubkeys.map(oraclePubkey => ({\n        pubkey: oraclePubkey,\n        isSigner: false,\n        isWritable: false,\n      })),\n    ];\n\n    const submitResponseIx =\n      program.instruction.pullFeedSubmitResponseConsensusLight(\n        instructionData,\n        {\n          accounts,\n          remainingAccounts,\n        }\n      );\n\n    // Load the lookup tables for the feeds and oracles.\n    const loadLookupTables = spl.createLoadLookupTables();\n    const luts = await loadLookupTables([\n      ...feedPubkeys.map(pubkey => new PullFeed(program, pubkey)),\n      ...oraclePubkeys.map(pubkey => new Oracle(program, pubkey)),\n    ]);\n\n    return [[secpInstruction, submitResponseIx], luts, response];\n  }\n\n  /**\n   *  Compiles a transaction instruction to submit oracle signatures for a given feed.\n   *\n   *  @param resps The oracle responses. This may be obtained from the `Gateway` class.\n   *  @param slot The slot at which the oracles signed the feed with the current slothash.\n   *  @returns A promise that resolves to the transaction instruction.\n   */\n  getSolanaSubmitSignaturesIx(params: {\n    resps: FeedEvalResponse[];\n    offsets: number[];\n    slot: BN;\n    payer?: web3.PublicKey;\n    chain?: string;\n  }): web3.TransactionInstruction {\n    const program = this.program;\n    const payerPublicKey = PullFeed.getPayer(program, params.payer);\n    const resps = params.resps.filter(x => (x.signature ?? '').length > 0);\n    const isSolana = getIsSolana(params.chain);\n\n    let queue = new web3.PublicKey(\n      Buffer.from(resps[0].queue_pubkey.toString(), 'hex')\n    );\n    const sourceQueueKey = new web3.PublicKey(\n      Buffer.from(resps[0].queue_pubkey.toString(), 'hex')\n    );\n    let queueBump = 0;\n\n    if (!isSolana) {\n      [queue, queueBump] = web3.PublicKey.findProgramAddressSync(\n        [Buffer.from('Queue'), queue.toBuffer()],\n        program.programId\n      );\n    }\n\n    const oracles = resps.map(x => {\n      const sourceOracleKey = new web3.PublicKey(\n        Buffer.from(x.oracle_pubkey.toString(), 'hex')\n      );\n      if (isSolana) {\n        return sourceOracleKey;\n      } else {\n        const [oraclePDA] = web3.PublicKey.findProgramAddressSync(\n          [Buffer.from('Oracle'), queue.toBuffer(), sourceOracleKey.toBuffer()],\n          program.programId\n        );\n        return oraclePDA;\n      }\n    });\n\n    const oracleFeedStats = oracles.map(\n      oracle =>\n        web3.PublicKey.findProgramAddressSync(\n          [Buffer.from('OracleStats'), oracle.toBuffer()],\n          program.programId\n        )[0]\n    );\n\n    const submissions = resps.map((resp, idx) => ({\n      value: new BN(resp.success_value.toString()),\n      signature: resp.signature,\n      recoveryId: resp.recovery_id,\n      // NOTE: offsets aren't used in the non-solana endpoint.\n      slotOffset: isSolana ? params.offsets[idx] : undefined,\n    }));\n\n    const instructionData = {\n      slot: new BN(params.slot),\n      submissions: submissions.map(x => ({\n        ...x,\n        signature: Buffer.from(x.signature, 'base64'),\n      })),\n      sourceQueueKey: isSolana ? undefined : sourceQueueKey,\n      queueBump: isSolana ? undefined : queueBump,\n    };\n\n    const accounts = {\n      feed: this.pubkey,\n      queue: queue,\n      programState: State.keyFromSeed(program),\n      recentSlothashes: SPL_SYSVAR_SLOT_HASHES_ID,\n      payer: payerPublicKey,\n      systemProgram: web3.SystemProgram.programId,\n      rewardVault: spl.getAssociatedTokenAddressSync(\n        SOL_NATIVE_MINT,\n        queue,\n        !isSolana\n      ),\n      tokenProgram: SPL_TOKEN_PROGRAM_ID,\n      tokenMint: SOL_NATIVE_MINT,\n    };\n\n    const remainingAccounts: web3.AccountMeta[] = [\n      ...oracles.map(k => ({\n        pubkey: k,\n        isSigner: false,\n        isWritable: false,\n      })),\n      ...oracleFeedStats.map(k => ({\n        pubkey: k,\n        isSigner: false,\n        isWritable: true,\n      })),\n    ];\n\n    if (isSolana) {\n      return program.instruction.pullFeedSubmitResponse(instructionData, {\n        accounts,\n        remainingAccounts,\n      });\n    } else {\n      return program.instruction.pullFeedSubmitResponseSvm(instructionData, {\n        accounts,\n        remainingAccounts,\n      });\n    }\n  }\n\n  /**\n   *  Checks if the pull feed account has been initialized.\n   *\n   *  @returns A promise that resolves to a boolean indicating if the account has been initialized.\n   */\n  async isInitializedAsync(): Promise<boolean> {\n    return !(await checkNeedsInit(\n      this.program.provider.connection,\n      this.program.programId,\n      this.pubkey\n    ));\n  }\n\n  /**\n   *  Loads the feed data for this {@linkcode PullFeed} account from on chain.\n   *\n   *  @returns A promise that resolves to the feed data.\n   *  @throws if the feed account does not exist.\n   */\n  async loadData(): Promise<PullFeedAccountData> {\n    if (this.data) return this.data;\n    this.data = await this.program.account['pullFeedAccountData'].fetch(\n      this.pubkey\n    );\n    return this.data!;\n  }\n\n  /**\n   *  Loads the feed data for multiple feeds at once.\n   *\n   *  @param program The program instance.\n   *  @param pubkeys The public keys of the feeds to load.\n   *  @returns A promise that resolves to an array of feed data (or null if the feed account does not exist)\n   */\n  static async loadMany(\n    program: Program,\n    feeds: PullFeed[]\n  ): Promise<(PullFeedAccountData | null)[]> {\n    const datas = await program.account['pullFeedAccountData'].fetchMultiple(\n      feeds.map(f => f.pubkey)\n    );\n    for (let i = 0; i < datas.length; i++) {\n      feeds[i].data = datas[i];\n    }\n    return datas;\n  }\n\n  /**\n   *  Loads the feed data for this {@linkcode PullFeed} account from on chain.\n   *\n   *  @returns A promise that resolves to the values currently stored in the feed.\n   *  @throws if the feed account does not exist.\n   */\n  async loadValues(): Promise<FeedSubmission[]> {\n    const data = await this.loadData();\n    return PullFeed.mapFeedSubmissions(data);\n  }\n\n  static mapFeedSubmissions(data: PullFeedAccountData): FeedSubmission[] {\n    const oldDP = Big.DP;\n    Big.DP = 40;\n    const submissions = data.submissions\n      .filter(x => !x.oracle.equals(web3.PublicKey.default))\n      .map(x => ({\n        value: new Big(x.value.toString()).div(1e18),\n        slot: new BN(x.slot.toString()),\n        oracle: new web3.PublicKey(x.oracle),\n      }));\n    Big.DP = oldDP;\n    return submissions;\n  }\n\n  async loadLookupTable(): Promise<web3.AddressLookupTableAccount> {\n    // If the lookup table is already loaded, return it\n    if (this.lut) return this.lut;\n\n    const lutKey = await this.lookupTableKey();\n    const accnt =\n      await this.program.provider.connection.getAddressLookupTable(lutKey);\n    this.lut = accnt.value!;\n    return this.lut!;\n  }\n}\n"]}