import { web3 } from '@coral-xyz/anchor-31';
/**
 * Configuration for signature-based authentication
 */
export interface SignatureAuthConfig {
    /** Keypair for signing */
    keypair: web3.Keypair;
    /** Solana connection for fetching blockhash */
    connection: web3.Connection;
    /** Refresh interval in milliseconds (default: 5 minutes for signature freshness) */
    refreshInterval?: number;
}
/**
 * Signed authentication data
 */
export interface SignedAuthData {
    signature: string;
    publicKey: string;
    blockhash: string;
    timestamp: number;
}
/**
 * Manages signature-based authentication for Switchboard service
 * Signs blockhash periodically to prove subscription and freshness
 */
export declare class SignatureAuth {
    private keypair;
    private connection;
    private refreshInterval;
    private currentAuthData?;
    private refreshTimer?;
    private lastRefreshTime;
    constructor(config: SignatureAuthConfig);
    /**
     * Check if signature auth is configured and enabled
     */
    isEnabled(): boolean;
    /**
     * Get the current auth headers, refreshing if necessary
     */
    getAuthHeaders(): Promise<Record<string, string> | null>;
    /**
     * Get the current auth data as an object (for WebSocket messages)
     */
    getAuthData(): Promise<SignedAuthData | null>;
    /**
     * Refresh the signature by fetching latest blockhash and signing
     */
    refresh(): Promise<void>;
    /**
     * Create the message to sign
     * Format: SHA256(blockhash:timestamp)
     */
    private createMessage;
    /**
     * Start automatic refresh timer
     */
    startAutoRefresh(): void;
    /**
     * Stop automatic refresh timer
     */
    stopAutoRefresh(): void;
    /**
     * Cleanup resources
     */
    destroy(): void;
}
//# sourceMappingURL=signatureAuth.d.ts.map