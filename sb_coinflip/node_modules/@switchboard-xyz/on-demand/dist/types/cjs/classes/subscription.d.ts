/**
 * Switchboard Subscription SDK
 *
 * High-level functions for managing Switchboard On-Demand subscriptions.
 * Allows users to create, upgrade, downgrade, and extend their subscriptions.
 */
import { Queue } from '../accounts/queue.js';
import { BN, web3 } from '@coral-xyz/anchor-31';
import { Connection, Keypair, PublicKey } from '@solana/web3.js';
/**
 * Switchboard Subscriber Program ID
 */
export declare const SUBSCRIPTION_PROGRAM_ID: web3.PublicKey;
/**
 * SWTCH Token Mint Address
 */
export declare const SWTCH_MINT: web3.PublicKey;
/**
 * SWTCH/USDT Feed ID for oracle pricing
 */
export declare const SWTCH_FEED_ID = "148aaedb33ff23593805377f131af7fe01b4770ae2b9e4a2f7f8b3a180314711";
/**
 * Subscription account information
 */
export interface SubscriptionInfo {
    owner: PublicKey;
    tierId: number;
    tierIdInTransition: number;
    subscriptionStartEpoch: BN;
    subscriptionEndEpoch: BN;
    lastTierChangeEpoch: BN;
    isActive: number;
    authorizedUsers: PublicKey[];
    authorizedUserCount: number;
    totalTokensPaid: BN;
    lastPaymentAmount: BN;
    lastPaymentToken: PublicKey;
    contactName: number[];
    contactEmail: number[];
}
/**
 * Parameters for creating a new subscription
 */
export interface CreateSubscriptionParams {
    /** Solana connection */
    connection: Connection;
    /** Payer and subscription owner */
    payer: Keypair;
    /** Tier ID (1=Free, 2=Pro, 3=Surge, 10+=Enterprise) */
    tierId: number;
    /** Number of epochs to pay for (minimum 2) */
    epochAmount: number;
    /** Optional contact name */
    contactName?: string;
    /** Optional contact email */
    contactEmail?: string;
    /** Switchboard queue for oracle updates */
    queue: Queue;
}
/**
 * Parameters for upgrading a subscription
 */
export interface UpgradeSubscriptionParams {
    /** Solana connection */
    connection: Connection;
    /** Subscription owner */
    owner: Keypair;
    /** New tier ID (must be more expensive than current) */
    newTierId: number;
    /** Number of epochs requested (credit applied, minimum 1) */
    epochAmount: number;
    /** Switchboard queue for oracle updates */
    queue: Queue;
}
/**
 * Parameters for downgrading a subscription
 * Note: Downgrade is credit-only - no payment or epoch amount needed
 */
export interface DowngradeSubscriptionParams {
    /** Solana connection */
    connection: Connection;
    /** Subscription owner */
    owner: Keypair;
    /** New tier ID (must be less expensive than current) */
    newTierId: number;
}
/**
 * Parameters for extending a subscription
 */
export interface ExtendSubscriptionParams {
    /** Solana connection */
    connection: Connection;
    /** Subscription owner (or admin if adminExtend=true) */
    owner: Keypair;
    /** Number of epochs to add */
    epochAmount: number;
    /** If true, no payment required (admin only) */
    adminExtend?: boolean;
    /** Switchboard queue for oracle updates (required if adminExtend=false) */
    queue?: Queue;
}
/**
 * Parameters for managing team members
 */
export interface ManageTeamMemberParams {
    /** Solana connection */
    connection: Connection;
    /** Subscription owner */
    owner: Keypair;
    /** User to add/remove */
    user: PublicKey;
}
/**
 * Create a new subscription
 *
 * @example
 * ```typescript
 * const sig = await createSubscription({
 *   connection,
 *   payer: userKeypair,
 *   tierId: 2, // Pro tier
 *   epochAmount: 15,
 *   contactName: 'Alice',
 *   contactEmail: 'alice@example.com',
 *   queue,
 * });
 * ```
 */
export declare function createSubscription(params: CreateSubscriptionParams): Promise<string>;
/**
 * Upgrade subscription to a more expensive tier
 *
 * @example
 * ```typescript
 * const sig = await upgradeSubscription({
 *   connection,
 *   owner: userKeypair,
 *   newTierId: 3, // Surge tier
 *   epochAmount: 15,
 *   queue,
 * });
 * ```
 */
export declare function upgradeSubscription(params: UpgradeSubscriptionParams): Promise<string>;
/**
 * Downgrade subscription to a less expensive tier
 *
 * @example
 * ```typescript
 * const sig = await downgradeSubscription({
 *   connection,
 *   owner: userKeypair,
 *   newTierId: 1, // Free tier
 *   epochAmount: 15,
 *   queue,
 * });
 * ```
 */
export declare function downgradeSubscription(params: DowngradeSubscriptionParams): Promise<string>;
/**
 * Extend an existing subscription
 *
 * @example
 * ```typescript
 * // User pays to extend
 * const sig = await extendSubscription({
 *   connection,
 *   owner: userKeypair,
 *   epochAmount: 10,
 *   queue,
 * });
 *
 * // Admin extends for free
 * const adminSig = await extendSubscription({
 *   connection,
 *   owner: adminKeypair,
 *   epochAmount: 30,
 *   adminExtend: true,
 * });
 * ```
 */
export declare function extendSubscription(params: ExtendSubscriptionParams): Promise<string>;
/**
 * Add a team member to the subscription
 *
 * @example
 * ```typescript
 * const sig = await addTeamMember({
 *   connection,
 *   owner: userKeypair,
 *   user: teammatePublicKey,
 * });
 * ```
 */
export declare function addTeamMember(params: ManageTeamMemberParams): Promise<string>;
/**
 * Remove a team member from the subscription
 *
 * @example
 * ```typescript
 * const sig = await removeTeamMember({
 *   connection,
 *   owner: userKeypair,
 *   user: teammatePublicKey,
 * });
 * ```
 */
export declare function removeTeamMember(params: ManageTeamMemberParams): Promise<string>;
/**
 * Fetch subscription information for an owner
 *
 * @example
 * ```typescript
 * const info = await fetchSubscriptionInfo({
 *   connection,
 *   owner: userPublicKey,
 * });
 *
 * console.log(`Tier: ${info.tierId}`);
 * console.log(`Active: ${info.isActive === 1}`);
 * console.log(`Epochs: ${info.subscriptionStartEpoch} - ${info.subscriptionEndEpoch}`);
 * ```
 */
export declare function fetchSubscriptionInfo(params: {
    connection: Connection;
    owner: PublicKey;
}): Promise<SubscriptionInfo | null>;
/**
 * Close an existing subscription and reclaim rent
 *
 * Note: Subscription must be expired or inactive to close
 *
 * @example
 * ```typescript
 * const sig = await closeSubscription({
 *   connection,
 *   owner: userKeypair,
 *   destination: userKeypair.publicKey, // Where to send rent refund
 * });
 * ```
 */
export declare function closeSubscription(params: {
    connection: Connection;
    owner: web3.Keypair;
    destination?: PublicKey;
}): Promise<string>;
/**
 * Build create subscription instruction (does not send transaction)
 * Use this for wallet adapters that need to sign transactions
 *
 * @example
 * ```typescript
 * const ix = await createSubscriptionIx({
 *   connection,
 *   owner: userPublicKey,
 *   tierId: 2,
 *   epochAmount: 15,
 *   queue,
 * });
 * // Sign and send with wallet adapter
 * await sendTransaction(transaction.add(ix), connection);
 * ```
 */
export declare function createSubscriptionIx(params: {
    connection: Connection;
    owner: PublicKey;
    tierId: number;
    epochAmount: number;
    contactName?: string;
    contactEmail?: string;
    queue: Queue;
}): Promise<web3.TransactionInstruction>;
/**
 * Build upgrade subscription instruction (does not send transaction)
 *
 * @example
 * ```typescript
 * const ix = await upgradeSubscriptionIx({
 *   connection,
 *   owner: userPublicKey,
 *   newTierId: 3,
 *   epochAmount: 15,
 *   queue,
 * });
 * ```
 */
export declare function upgradeSubscriptionIx(params: {
    connection: Connection;
    owner: PublicKey;
    newTierId: number;
    epochAmount: number;
    queue: Queue;
}): Promise<web3.TransactionInstruction>;
/**
 * Build downgrade subscription instruction (does not send transaction)
 * Note: Downgrade is credit-only, no oracle needed
 *
 * @example
 * ```typescript
 * const ix = await downgradeSubscriptionIx({
 *   connection,
 *   owner: userPublicKey,
 *   newTierId: 1,
 * });
 * ```
 */
export declare function downgradeSubscriptionIx(params: {
    connection: Connection;
    owner: PublicKey;
    newTierId: number;
}): Promise<web3.TransactionInstruction>;
/**
 * Build extend subscription instruction (does not send transaction)
 *
 * @example
 * ```typescript
 * const ix = await extendSubscriptionIx({
 *   connection,
 *   owner: userPublicKey,
 *   epochAmount: 10,
 *   queue,
 * });
 * ```
 */
export declare function extendSubscriptionIx(params: {
    connection: Connection;
    owner: PublicKey;
    epochAmount: number;
    adminExtend?: boolean;
    queue?: Queue;
}): Promise<web3.TransactionInstruction>;
/**
 * Build add team member instruction (does not send transaction)
 *
 * @example
 * ```typescript
 * const ix = await addTeamMemberIx({
 *   connection,
 *   owner: userPublicKey,
 *   user: teamMemberPublicKey,
 * });
 * ```
 */
export declare function addTeamMemberIx(params: {
    connection: Connection;
    owner: PublicKey;
    user: PublicKey;
}): Promise<web3.TransactionInstruction>;
/**
 * Build remove team member instruction (does not send transaction)
 *
 * @example
 * ```typescript
 * const ix = await removeTeamMemberIx({
 *   connection,
 *   owner: userPublicKey,
 *   user: teamMemberPublicKey,
 * });
 * ```
 */
export declare function removeTeamMemberIx(params: {
    connection: Connection;
    owner: PublicKey;
    user: PublicKey;
}): Promise<web3.TransactionInstruction>;
/**
 * Build close subscription instruction (does not send transaction)
 *
 * @example
 * ```typescript
 * const ix = await closeSubscriptionIx({
 *   connection,
 *   owner: userPublicKey,
 *   destination: userPublicKey,
 * });
 * ```
 */
export declare function closeSubscriptionIx(params: {
    connection: Connection;
    owner: PublicKey;
    destination?: PublicKey;
}): Promise<web3.TransactionInstruction>;
/**
 * Initialize the subscriber program state (one-time setup, admin only)
 *
 * Must be called by program upgrade authority
 *
 * @example
 * ```typescript
 * const sig = await initializeState({
 *   connection,
 *   authority: authorityKeypair,
 *   swtchMint: new PublicKey('SW1TCH...'),
 *   swtchFeedId: '148aaedb33ff23593805377f131af7fe01b4770ae2b9e4a2f7f8b3a180314711',
 * });
 * ```
 */
export declare function initializeState(params: {
    connection: Connection;
    authority: web3.Keypair;
    payer?: web3.Keypair;
    swtchMint: PublicKey;
    swtchFeedId: string;
}): Promise<string>;
/**
 * Update program state configuration (admin only)
 *
 * @example
 * ```typescript
 * const sig = await updateStateConfig({
 *   connection,
 *   authority: authorityKeypair,
 *   swtchMint: new PublicKey('NEW_MINT...'),
 *   swtchFeedId: 'new_feed_id_hex',
 * });
 * ```
 */
export declare function updateStateConfig(params: {
    connection: Connection;
    authority: web3.Keypair;
    swtchMint?: PublicKey;
    swtchFeedId?: string;
    epochLength?: number;
}): Promise<string>;
/**
 * Create a new pricing tier (admin only)
 *
 * @example
 * ```typescript
 * const sig = await createTier({
 *   connection,
 *   authority: authorityKeypair,
 *   tierId: 2,
 *   name: 'Pro',
 *   displayName: 'Pro Plan',
 *   description: 'Professional tier with enhanced limits',
 *   maxConnections: 15,
 *   maxFeeds: 300,
 *   maxFeedsPerIx: 6,
 *   minDelayMs: 300,
 *   maxAuthorizedUsers: 5,
 *   costPerEpochUsdCents: 10000, // 100 USD per epoch
 *   isPublic: true,
 * });
 * ```
 */
export declare function createTier(params: {
    connection: Connection;
    authority: web3.Keypair;
    payer?: web3.Keypair;
    tierId: number;
    name: string;
    displayName: string;
    description: string;
    maxConnections: number;
    maxFeeds: number;
    maxFeedsPerIx: number;
    minDelayMs: number;
    maxAuthorizedUsers: number;
    costPerEpochUsdCents: number;
    isPublic: boolean;
}): Promise<string>;
/**
 * Update an existing tier (admin only)
 *
 * All parameters are optional - only provided values will be updated
 *
 * @example
 * ```typescript
 * const sig = await updateTier({
 *   connection,
 *   authority: authorityKeypair,
 *   tierId: 2,
 *   costPerEpochUsdCents: 15000, // Update price to 150 USD
 *   minDelayMs: 100, // Update rate limit
 * });
 * ```
 */
export declare function updateTier(params: {
    connection: Connection;
    authority: web3.Keypair;
    tierId: number;
    name?: string;
    displayName?: string;
    description?: string;
    maxConnections?: number;
    maxFeeds?: number;
    maxFeedsPerIx?: number;
    minDelayMs?: number;
    maxAuthorizedUsers?: number;
    costPerEpochUsdCents?: number;
    isPublic?: boolean;
    enabled?: boolean;
}): Promise<string>;
/**
 * Admin-managed subscription update (admin only)
 *
 * Allows admins to forcefully change tier, activate/deactivate, extend for free, or update contact info
 *
 * @example
 * ```typescript
 * // Force tier change
 * const sig = await adminManageSubscription({
 *   connection,
 *   authority: authorityKeypair,
 *   owner: new PublicKey('user...'),
 *   setTierId: 3,
 * });
 *
 * // Extend subscription for free
 * const sig = await adminManageSubscription({
 *   connection,
 *   authority: authorityKeypair,
 *   owner: new PublicKey('user...'),
 *   extendEpochs: 30,
 * });
 *
 * // Deactivate subscription
 * const sig = await adminManageSubscription({
 *   connection,
 *   authority: authorityKeypair,
 *   owner: new PublicKey('user...'),
 *   setActive: false,
 * });
 * ```
 */
export declare function adminManageSubscription(params: {
    connection: Connection;
    authority: web3.Keypair;
    owner: PublicKey;
    setTierId?: number;
    setActive?: boolean;
    extendEpochs?: number;
    updateContactName?: string;
    updateContactEmail?: string;
}): Promise<string>;
/**
 * Admin-only tier change with automatic pro-rating (admin only)
 *
 * @example
 * ```typescript
 * const sig = await adminSetTier({
 *   connection,
 *   authority: authorityKeypair,
 *   owner: new PublicKey('user...'),
 *   newTierId: 3,
 * });
 * ```
 */
export declare function adminSetTier(params: {
    connection: Connection;
    authority: web3.Keypair;
    owner: PublicKey;
    newTierId: number;
}): Promise<string>;
//# sourceMappingURL=subscription.d.ts.map